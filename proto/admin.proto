syntax = "proto3";
package talos;
option go_package = "./proto";

service AdminService {
  rpc UpdatePolicy (UpdatePolicyRequest) returns (UpdatePolicyResponse);
  rpc WatchPolicies (WatchRequest) returns (stream PolicyUpdate);
}

message Policy {
  string subject = 1;
  string action = 2;
  string effect = 3;
}

message UpdatePolicyRequest {
  string subject = 1;
  string action = 2;
  string effect = 3;
}

message UpdatePolicyResponse {
  bool success = 1;
  string error_message = 2;
}

message WatchRequest {
  string node_id = 1;
  string auth_token = 2; // Added Kubernetes ServiceAccount Token
}

message PolicyUpdate {
  repeated Policy policies = 1;
}