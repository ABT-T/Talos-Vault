syntax = "proto3";

package admin;

option go_package = "github.com/example/talos-vault/proto";

// Service definition
service AdminService {
  rpc GetPolicy(PolicyRequest) returns (PolicyResponse);
  rpc ReportAudit(AuditRequest) returns (AuditResponse); // New RPC for logging
}

// Existing Policy messages
message PolicyRequest {
  string node_id = 1;
  string os_version = 2;
}

message PolicyResponse {
  repeated Policy policies = 1;
}

message Policy {
  string subject = 1;
  string resource = 2;
  string action = 3;
  string effect = 4;
}

// New Audit messages
message AuditRequest {
  string node_id = 1;
  string subject = 2;
  string action = 3;
  string effect = 4;
  string resource = 5;
  int64 timestamp = 6; // Unix timestamp
}

message AuditResponse {
  bool success = 1;
}